
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>bfdtd.snapshot &#8212; script_inception_public  documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">script_inception_public  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for bfdtd.snapshot</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This module defines the basic snapshots and some additional snapshot objects for convenience.</span>

<span class="sd">.. digraph:: snapshot_system_diagram</span>

<span class="sd">    &quot;Snapshot&quot; -&gt; &quot;FrequencySnapshot&quot;</span>
<span class="sd">    &quot;Snapshot&quot; -&gt; &quot;TimeSnapshot&quot;</span>
<span class="sd">    </span>
<span class="sd">    &quot;FrequencySnapshot&quot; -&gt; &quot;EnergySnapshot&quot;</span>
<span class="sd">    &quot;EnergySnapshot&quot; -&gt; &quot;ModeVolumeBox&quot;</span>
<span class="sd">    &quot;ModeVolumeBox&quot; -&gt; &quot;ModeVolumeBoxFull&quot;</span>

<span class="sd">    &quot;TimeSnapshot&quot; -&gt; &quot;ModeFilteredProbe&quot;</span>
<span class="sd">    &quot;TimeSnapshot&quot; -&gt; &quot;EpsilonSnapshot&quot;</span>
<span class="sd">    </span>
<span class="sd">    &quot;EpsilonSnapshot&quot; -&gt; &quot;EpsilonBox&quot;</span>
<span class="sd">    &quot;EpsilonBox&quot; -&gt; &quot;EpsilonBoxFull&quot;</span>

<span class="sd">    &quot;SnapshotBox&quot; -&gt; &quot;SnapshotBoxXYZ&quot;</span>
<span class="sd">    &quot;SnapshotBox&quot; -&gt; &quot;SnapshotBoxSurface&quot;</span>
<span class="sd">    &quot;SnapshotBox&quot; -&gt; &quot;SnapshotBoxVolume&quot;</span>

<span class="sd">Deprecated notes. To be updated at some point.:</span>

<span class="sd">  * IDEA:</span>

<span class="sd">    * main bfdtd class writer calls snap.write(file, mesh)</span>
<span class="sd">    * main snap class defines mainwrite(file, mesh, subwrite) (which writes one or multiple snap entries to file)</span>
<span class="sd">    * sub snap classes (freq,time,etc) define subwrite() (which just writes single snap entry to file)</span>
<span class="sd">    * sub snap classes define write(file, mesh) which calls mainwrite(file, mesh, subwrite)</span>

<span class="sd">  * NOTES:</span>

<span class="sd">    * When P1,P2 do not form a plane, a single snapshot is created at X1 if plane=1, Y1 if plane=2, Z1 if plane=3, i.e. P1 is used for positioning the slice.</span>
<span class="sd">    * When coordinates in P1 or P2 do not correspond to a mesh point, they are snapped to the closest one.</span>
<span class="sd">    * When X1&gt;X2 or similar: Behaviour unknown!!! </span>

<span class="sd">  * Writing methods:</span>

<span class="sd">    * single plane if (P1,P2) form a plane.</span>
<span class="sd">    * 6 planes, one on each side if (P1,P2) form a box.</span>
<span class="sd">    * N planes in X, Y or Z based on mesh if (P1,P2) form a box.</span>
<span class="sd">    * 3 planes (X,Y,Z) intersecting at (P1+P2)/2.</span>

<span class="sd">  * The main writing function should be the same for all snapshots and call the specific writing functions depending on an attribute defining which one is desired.</span>

<span class="sd">  * The specific writing functions of the base class should be overridden in the child classes.</span>

<span class="sd">.. todo:: Check snapshot behaviour when X1&gt;X2 or similar.</span>
<span class="sd">.. todo:: add IDs and sub-IDs and maybe some new brackets in the generated .inp/.geo files to be able to group snapshots for post-processing (mode volume in particular). Extend comment syntax.</span>
<span class="sd">.. todo:: update doc</span>
<span class="sd">.. todo:: add name extensions again (X+,X-, etc)</span>
<span class="sd">.. todo:: indent entries? Put 3D vectors on a single line?</span>
<span class="sd">.. todo:: Figure out why &quot;make html&quot; for the doc crashes on TimeSnapshot import. &quot;make clean html&quot; works. Could be due to &quot;import bfdtd.bfdtd_parser&quot; in here (recursive import?).</span>
<span class="sd">.. todo:: add print functions</span>

<span class="sd">.. todo:: Add unit tests...</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">code</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span>

<span class="kn">import</span> <span class="nn">utilities.common</span>
<span class="kn">from</span> <span class="nn">utilities.common</span> <span class="k">import</span> <span class="n">fixLowerUpper</span><span class="p">,</span> <span class="n">planeNumberName</span><span class="p">,</span> <span class="n">float_array</span><span class="p">,</span> <span class="n">findNearest</span><span class="p">,</span> <span class="n">findNearestInSortedArray</span>
<span class="kn">from</span> <span class="nn">constants.physcon</span> <span class="k">import</span> <span class="n">get_c0</span>
<span class="kn">from</span> <span class="nn">utilities.brisFDTD_ID_info</span> <span class="k">import</span> <span class="n">numID_to_alphaID_TimeSnapshot</span><span class="p">,</span> <span class="n">numID_to_alphaID_FrequencySnapshot</span><span class="p">,</span> <span class="n">numID_to_alphaID_ModeFilteredProbe</span>

<span class="kn">from</span> <span class="nn">bfdtd.meshobject</span> <span class="k">import</span> <span class="n">MeshObject</span>

<span class="c1">#from .BFDTDobject import *</span>
<span class="c1">#from bfdtd.BFDTDobject import BFDTDobject</span>

<div class="viewcode-block" id="Snapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot">[docs]</a><span class="k">class</span> <span class="nc">Snapshot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Simple base class for all single-entry BFDTD snapshots.</span>

<span class="sd">  Attributes:</span>
<span class="sd">  </span>
<span class="sd">    * first: integer</span>
<span class="sd">    * repetition: integer</span>
<span class="sd">    * plane: integer</span>
<span class="sd">    * P1: 3D vector</span>
<span class="sd">    * P2: 3D vector</span>
<span class="sd">    * E: 3D vector</span>
<span class="sd">    * H: 3D vector</span>
<span class="sd">    * J: 3D vector</span>
<span class="sd">  </span>
<span class="sd">  .. note:: Plane snapshots will never output data for the upper edges of the simulation box.</span>
<span class="sd">  </span>
<span class="sd">            Example: Box from (0,0,0) to (1,1,1) with Z snapshot from (0,0) to (1,1) -&gt; Snapshot output will not contain any points along the x=1 and y=1 lines.</span>
<span class="sd">            </span>
<span class="sd">            A Z snapshot at z=1 will however still output data!</span>
<span class="sd">  </span>
<span class="sd">  .. todo:: Add pictures and examples to this doc.</span>
<span class="sd">  </span>
<span class="sd">  .. todo:: Finish this... New problem: frequency snapshots with a frequency list. Solution: custom write function, which calls mainclass write for each frequency, which itself calls fsnap class write_entry function?</span>
<span class="sd">  .. todo:: Location + relative P1/P2 system like for blocks? Might make creating an aditional base class worth it?</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="c1"># define attributes and set default values</span>

    <span class="c1"># attributes common to most BFDTD objects</span>
    <span class="c1"># These variables might go into a main &quot;bfdtd item&quot; class used by geometry and measurement objects later on.</span>
    <span class="c1"># if self.name is None, the name is adapted based on the plane orientation (an additional comment item about the orientation might be added later)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">useForMeshing</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># set to False to disable use of this object during automeshing</span>

    <span class="c1"># main &quot;measurement&quot; properties</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># crashes if = 0</span>
    <span class="c1">#self.repetition = 524200</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span> <span class="o">=</span> <span class="mi">500000</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># main &quot;geometric&quot; properties</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_plane</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span> <span class="c1">#1,2,3 for x,y,z</span>
    <span class="c1"># P1,P2 are internal variables (not to be used directly by the user) and could be replaced by size/centre or lower/upper in the future</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">#self.snapshot_type = &#39;plane&#39; # can be &#39;plane&#39;, &#39;box_surface&#39; or &#39;box_volume&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">full_extension_bool</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># determines whether the snapshot should fully extend across the mesh or be limited to the specified P1,P2 points</span>
    <span class="k">return</span>

<div class="viewcode-block" id="Snapshot.getTypeBasedOnAttributes"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getTypeBasedOnAttributes">[docs]</a>  <span class="k">def</span> <span class="nf">getTypeBasedOnAttributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns class by default, but overloaded in the TimeSnapshot class to differentiate time and epsilon snapshots.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span></div>

<div class="viewcode-block" id="Snapshot.setStartingSample"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setStartingSample">[docs]</a>  <span class="k">def</span> <span class="nf">setStartingSample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starting_sample</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    dummy function, to be re-implemented in subclasses, such as FrequencySnapshot</span>
<span class="sd">    .. todo:: Why not just give it to all? no need for FrequencySnapshot defining it then...</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">pass</span></div>
    
<div class="viewcode-block" id="Snapshot.setFullExtensionOn"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setFullExtensionOn">[docs]</a>  <span class="k">def</span> <span class="nf">setFullExtensionOn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">full_extension_bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.setFullExtensionOff"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setFullExtensionOff">[docs]</a>  <span class="k">def</span> <span class="nf">setFullExtensionOff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">full_extension_bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.setFromSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setFromSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_in</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Copies the properties from *snapshot_in*.</span>

<span class="sd">    .. todo:: Use loops over object dirs? Look for existing function in python? Should remove need for additional functions in subclasses.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">group</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">useForMeshing</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">useForMeshing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">repetition</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">E</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">H</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">J</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">full_extension_bool</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">full_extension_bool</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtensionFromSnapshot</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.setExtensionFromSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setExtensionFromSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">setExtensionFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_in</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Copies the *P1*, *P2* and *plane* attributes from *snapshot_in*, i.e. the extension and the plane orientation.</span>
<span class="sd">    </span>
<span class="sd">    .. todo:: turn this into a constructor if possible.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtension</span><span class="p">(</span><span class="o">*</span><span class="n">snapshot_in</span><span class="o">.</span><span class="n">getExtension</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">plane</span>
    <span class="k">return</span></div>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">plane</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; orientation of the snapshot plane &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plane</span>

  <span class="nd">@plane</span><span class="o">.</span><span class="n">setter</span>
  <span class="k">def</span> <span class="nf">plane</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]:</span>
      <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;plane has to be &#39;x&#39;,&#39;y&#39; or &#39;z&#39;&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_plane</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;printing function&#39;&#39;&#39;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;name = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;layer = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;group = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;useForMeshing = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">useForMeshing</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;first = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;repetition = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repetition</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;plane = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;P1 = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;P2 = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>    
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;E = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;H = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;J = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="Snapshot.getName"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getName">[docs]</a>  <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span></div>
  
<div class="viewcode-block" id="Snapshot.setName"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setName">[docs]</a>  <span class="k">def</span> <span class="nf">setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span></div>
<div class="viewcode-block" id="Snapshot.setLayer"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setLayer">[docs]</a>  <span class="k">def</span> <span class="nf">setLayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="n">layer</span></div>
<div class="viewcode-block" id="Snapshot.setGroup"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setGroup">[docs]</a>  <span class="k">def</span> <span class="nf">setGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span></div>
<div class="viewcode-block" id="Snapshot.setUseForMeshing"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setUseForMeshing">[docs]</a>  <span class="k">def</span> <span class="nf">setUseForMeshing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">useForMeshing</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">useForMeshing</span> <span class="o">=</span> <span class="n">useForMeshing</span></div>

<div class="viewcode-block" id="Snapshot.getFirst"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getFirst">[docs]</a>  <span class="k">def</span> <span class="nf">getFirst</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span></div>

<div class="viewcode-block" id="Snapshot.setFirst"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setFirst">[docs]</a>  <span class="k">def</span> <span class="nf">setFirst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span></div>

<div class="viewcode-block" id="Snapshot.getRepetition"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getRepetition">[docs]</a>  <span class="k">def</span> <span class="nf">getRepetition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repetition</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Snapshot.setRepetition"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setRepetition">[docs]</a>  <span class="k">def</span> <span class="nf">setRepetition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repetition</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span> <span class="o">=</span> <span class="n">repetition</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repetition</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Snapshot.setEfield"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setEfield">[docs]</a>  <span class="k">def</span> <span class="nf">setEfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">E_vec3</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">E_vec3</span><span class="p">)</span></div>
<div class="viewcode-block" id="Snapshot.setHfield"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setHfield">[docs]</a>  <span class="k">def</span> <span class="nf">setHfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H_vec3</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">H_vec3</span><span class="p">)</span></div>
<div class="viewcode-block" id="Snapshot.setJfield"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setJfield">[docs]</a>  <span class="k">def</span> <span class="nf">setJfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">J_vec3</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">J_vec3</span><span class="p">)</span></div>

<div class="viewcode-block" id="Snapshot.getEfield"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getEfield">[docs]</a>  <span class="k">def</span> <span class="nf">getEfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">))</span></div>
<div class="viewcode-block" id="Snapshot.getHfield"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getHfield">[docs]</a>  <span class="k">def</span> <span class="nf">getHfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">))</span></div>
<div class="viewcode-block" id="Snapshot.getJfield"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getJfield">[docs]</a>  <span class="k">def</span> <span class="nf">getJfield</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">))</span></div>

<div class="viewcode-block" id="Snapshot.getPlaneBfdtdIndex"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getPlaneBfdtdIndex">[docs]</a>  <span class="k">def</span> <span class="nf">getPlaneBfdtdIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">plane_letter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">][[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">plane_letter</span><span class="o">.</span><span class="n">lower</span><span class="p">())]</span></div>
<div class="viewcode-block" id="Snapshot.setPlaneBfdtdIndex"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setPlaneBfdtdIndex">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneBfdtdIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bfdtd_index</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">][</span><span class="n">bfdtd_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.getPlanePythonIndex"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getPlanePythonIndex">[docs]</a>  <span class="k">def</span> <span class="nf">getPlanePythonIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">plane_letter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">plane_letter</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span></div>
<div class="viewcode-block" id="Snapshot.setPlanePythonIndex"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setPlanePythonIndex">[docs]</a>  <span class="k">def</span> <span class="nf">setPlanePythonIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">python_index</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">][</span><span class="n">python_index</span><span class="p">]</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.getPlaneLetter"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getPlaneLetter">[docs]</a>  <span class="k">def</span> <span class="nf">getPlaneLetter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; return letter describing plane orientation (&#39;x&#39;,&#39;y&#39; or &#39;z&#39;) &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span></div>
<div class="viewcode-block" id="Snapshot.setPlaneLetter"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setPlaneLetter">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneLetter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plane_letter</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; set plane orientation by passing &#39;x&#39;,&#39;y&#39; or &#39;z&#39; &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">plane_letter</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]:</span>
      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;plane_letter must be &#39;x&#39;,&#39;y&#39; or &#39;z&#39;&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="n">plane_letter</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.setPlaneOrientationX"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setPlaneOrientationX">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneOrientationX</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span></div>
<div class="viewcode-block" id="Snapshot.setPlaneOrientationY"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setPlaneOrientationY">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneOrientationY</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span></div>
<div class="viewcode-block" id="Snapshot.setPlaneOrientationZ"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setPlaneOrientationZ">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneOrientationZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span></div>
  
<div class="viewcode-block" id="Snapshot.getCentro"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getCentro">[docs]</a>  <span class="k">def</span> <span class="nf">getCentro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">)</span> <span class="o">+</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">))</span> <span class="p">)</span></div>
    
<div class="viewcode-block" id="Snapshot.getSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getSize">[docs]</a>  <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">)</span> <span class="o">-</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">)</span> <span class="p">)</span></div>
    
<div class="viewcode-block" id="Snapshot.setCentro"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setCentro">[docs]</a>  <span class="k">def</span> <span class="nf">setCentro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">centro_vec3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Reposition the snapshot so that ``(P1+P2)/2 = centro_vec3``, i.e. its centre is at *centro_vec3*.</span>
<span class="sd">    </span>
<span class="sd">    .. todo:: location or centre? centre is clearly defined, but location allows flexible positioning of the &quot;origin of the object&quot;. But do we need that?</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">size_vec3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="n">centro_vec3</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">size_vec3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">centro_vec3</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">size_vec3</span></div>
        
<div class="viewcode-block" id="Snapshot.setSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setSize">[docs]</a>  <span class="k">def</span> <span class="nf">setSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_vec3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set the size of the snapshot, i.e. *[size_x, size_y, size_z] = P2 - P1*.</span>
<span class="sd">    </span>
<span class="sd">    :param size_vec3: A list or array of length 3, or a scalar int or float value. If a scalar *S* is passed, the size vector *[S, S, S]* will be used.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size_vec3</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
      <span class="n">size_vec3</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">size_vec3</span><span class="p">,</span> <span class="n">size_vec3</span><span class="p">,</span> <span class="n">size_vec3</span><span class="p">])</span>
    <span class="n">centro_vec3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCentro</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="n">centro_vec3</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">array</span><span class="p">(</span><span class="n">size_vec3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">centro_vec3</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">array</span><span class="p">(</span><span class="n">size_vec3</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Snapshot.getLower"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getLower">[docs]</a>  <span class="k">def</span> <span class="nf">getLower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns the lower corner (P1).&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">)</span></div>
<div class="viewcode-block" id="Snapshot.getUpper"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getUpper">[docs]</a>  <span class="k">def</span> <span class="nf">getUpper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns the upper corner (P1).&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">)</span></div>

<div class="viewcode-block" id="Snapshot.getExtension"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getExtension">[docs]</a>  <span class="k">def</span> <span class="nf">getExtension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns the *extension*, i.e. *(lower, upper) = (P1,P2)*.&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">fixLowerUpper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">),</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">))</span></div>

<div class="viewcode-block" id="Snapshot.setExtension"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setExtension">[docs]</a>  <span class="k">def</span> <span class="nf">setExtension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerCorner_vec3</span><span class="p">,</span> <span class="n">upperCorner_vec3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Set the extension of the snapshot, i.e. its lower and upper corners.</span>
<span class="sd">    </span>
<span class="sd">    If you have an (L,U) tuple like the one you get from getExtension(), you can pass it directly via python&#39;s unpacking feature as follows::</span>
<span class="sd">    </span>
<span class="sd">      obj.setExtension(*sim.getExtension())</span>
<span class="sd">      </span>
<span class="sd">    .. todo:: Make above default behaviour? Support both?</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># if upperCorner is None and isinstance(f,tuple) and len()==2:</span>
    <span class="c1">#if lowerCorner_vec3 is None or upperCorner_vec3 is None:</span>
      <span class="c1">#self.P1 = lowerCorner_vec3</span>
      <span class="c1">#self.P2 = upperCorner_vec3</span>
    <span class="c1">#else:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">fixLowerUpper</span><span class="p">(</span><span class="n">lowerCorner_vec3</span><span class="p">,</span> <span class="n">upperCorner_vec3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Snapshot.setExtensionX"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setExtensionX">[docs]</a>  <span class="k">def</span> <span class="nf">setExtensionX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.setExtensionY"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setExtensionY">[docs]</a>  <span class="k">def</span> <span class="nf">setExtensionY</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.setExtensionZ"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.setExtensionZ">[docs]</a>  <span class="k">def</span> <span class="nf">setExtensionZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span>
    <span class="k">return</span></div>
  
<div class="viewcode-block" id="Snapshot.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;This function has to be implemented by child classes.&#39;</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Snapshot.getMeshingParameters"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.getMeshingParameters">[docs]</a>  <span class="k">def</span> <span class="nf">getMeshingParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span><span class="p">):</span>
    <span class="n">objx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">objy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">objz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">xvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xvec</span><span class="p">,</span><span class="n">objx</span><span class="p">])</span>
    <span class="n">yvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">yvec</span><span class="p">,</span><span class="n">objy</span><span class="p">])</span>
    <span class="n">zvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">zvec</span><span class="p">,</span><span class="n">objz</span><span class="p">])</span>
    <span class="n">epsx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsx</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsy</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsz</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span></div>

<div class="viewcode-block" id="Snapshot.read_data"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.read_data">[docs]</a>  <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data3D</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fsnap_numID</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tsnap_numID</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">probe_ident</span><span class="o">=</span><span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dataPaths</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">],</span> <span class="n">testrun</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    .. todo:: Careful with dataPaths searching. Maybe add a warning + display full path. We don&#39;t want Matlab-like accidental random data loading...</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="p">(</span><span class="n">filename_list</span><span class="p">,</span> <span class="n">fsnap_numID_out</span><span class="p">,</span> <span class="n">tsnap_numID_out</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFileNames</span><span class="p">(</span><span class="n">fsnap_numID</span><span class="p">,</span> <span class="n">tsnap_numID</span><span class="p">,</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># locate file</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">dataPaths</span><span class="p">:</span>
      <span class="n">dataPaths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dataPaths</span><span class="p">:</span>
      <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
        <span class="k">break</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.read_data fsnap_numID: </span><span class="si">{}</span><span class="s1">-&gt;</span><span class="si">{}</span><span class="s1"> tsnap_numID = </span><span class="si">{}</span><span class="s1">-&gt;</span><span class="si">{}</span><span class="s1"> filepath = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">fsnap_numID</span><span class="p">,</span> <span class="n">fsnap_numID_out</span><span class="p">,</span> <span class="n">tsnap_numID</span><span class="p">,</span> <span class="n">tsnap_numID_out</span><span class="p">,</span> <span class="n">filepath</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;File not found: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">testrun</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">data3D</span><span class="p">,</span> <span class="n">fsnap_numID_out</span><span class="p">,</span> <span class="n">tsnap_numID_out</span><span class="p">)</span>

    <span class="c1"># get fixed position</span>
    <span class="n">plane_py_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlanePythonIndex</span><span class="p">()</span>
    <span class="n">fixed_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCentro</span><span class="p">()[</span><span class="n">plane_py_idx</span><span class="p">]</span>

    <span class="n">data2D</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">data2D</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>

    <span class="c1">#print(&#39;header&#39;, header)</span>
    <span class="c1">#print(&#39;data2D&#39;, data2D)</span>
    <span class="c1">#print(&#39;data2D[material]&#39;, data2D[&#39;material&#39;])</span>

    <span class="c1">#for k in header[2:]:</span>
      <span class="c1">#print(k)</span>
    
    <span class="c1"># read rows</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data2D</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">plane_py_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">fixed_position</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
      <span class="k">elif</span> <span class="n">plane_py_idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">fixed_position</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">fixed_position</span>
      <span class="c1">#print(x, y, z, row[&#39;material&#39;])</span>
      <span class="p">(</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">),</span> <span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">z_val</span><span class="p">)</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getNearest</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
      
      <span class="bp">self</span><span class="o">.</span><span class="n">fillData</span><span class="p">(</span><span class="n">data3D</span><span class="p">,</span> <span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
      
      <span class="c1">#for k in header[2:]:</span>
        <span class="c1">#print(k)</span>
        <span class="c1">#print(row[k])</span>
        <span class="c1">#print(data3D[x_idx, y_idx, z_idx])</span>
        <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;E&#39;])</span>
        <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;H&#39;])</span>
        <span class="c1">#data3D[x_idx, y_idx, z_idx][k] = row[k]</span>
      <span class="c1">#data_epsilon[x_idx, y_idx, z_idx][&#39;epsilon&#39;] = row[&#39;material&#39;]</span>
      <span class="c1">#data_epsilon[x_idx, y_idx, z_idx] = row[&#39;material&#39;]</span>
      
    <span class="k">return</span> <span class="p">(</span><span class="n">data3D</span><span class="p">,</span> <span class="n">fsnap_numID_out</span><span class="p">,</span> <span class="n">tsnap_numID_out</span><span class="p">)</span></div>

<div class="viewcode-block" id="Snapshot.write_data"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.Snapshot.write_data">[docs]</a>  <span class="k">def</span> <span class="nf">write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    .. todo:: This function currently always assumes full snapshots. However, the snapshot area could be smaller, in which case, only part of the mesh should be looped through...</span>
<span class="sd">    .. todo:: Should be re-implemented by energy snapshots to increase processing speed by writing to two files at the same time.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="p">(</span><span class="n">filename_list</span><span class="p">,</span> <span class="n">fsnap_numID</span><span class="p">,</span> <span class="n">tsnap_numID</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFileNames</span><span class="p">(</span><span class="n">numID</span><span class="p">,</span> <span class="n">numID</span><span class="p">,</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.write_data numID = </span><span class="si">{}</span><span class="s1"> filename = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">numID</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
      
      <span class="c1"># set up csvwriter</span>
      <span class="n">fieldnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOutputColumnHeaders</span><span class="p">()</span>
      <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
      <span class="n">csvwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">fieldnames</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">)</span>
      
      <span class="c1"># write header</span>
      <span class="n">csvfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
      <span class="n">csvwriter</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>
      
      <span class="c1"># get fixed position</span>
      <span class="n">plane_py_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlanePythonIndex</span><span class="p">()</span>
      <span class="n">fixed_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCentro</span><span class="p">()[</span><span class="n">plane_py_idx</span><span class="p">]</span>
      
      <span class="c1"># write rows</span>
      <span class="k">if</span> <span class="n">plane_py_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">fixed_position</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getYmesh</span><span class="p">():</span>
          <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getZmesh</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_data_row</span><span class="p">(</span><span class="n">csvwriter</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
          <span class="n">csvfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
          
      <span class="k">elif</span> <span class="n">plane_py_idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">fixed_position</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getXmesh</span><span class="p">():</span>
          <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getZmesh</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_data_row</span><span class="p">(</span><span class="n">csvwriter</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
          <span class="n">csvfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
          
      <span class="k">else</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">fixed_position</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getXmesh</span><span class="p">():</span>
          <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getYmesh</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_data_row</span><span class="p">(</span><span class="n">csvwriter</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
          <span class="n">csvfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">return</span></div></div>

<div class="viewcode-block" id="FrequencySnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot">[docs]</a><span class="k">class</span> <span class="nc">FrequencySnapshot</span><span class="p">(</span><span class="n">Snapshot</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Simple base class for all single-entry BFDTD snapshots written as *FREQUENCY_SNAPSHOT* in .inp files.</span>

<span class="sd">  Attributes:</span>
<span class="sd">  </span>
<span class="sd">    * interpolate: 0 or 1</span>
<span class="sd">    * real_dft: 0 or 1</span>
<span class="sd">    * mod_only: 0 or 1</span>
<span class="sd">    * mod_all: 0 or 1</span>
<span class="sd">    * frequency_vector: float vector</span>
<span class="sd">    * starting_sample: integer</span>

<span class="sd">  The format of a frequency snapshot object is:</span>
<span class="sd">  </span>
<span class="sd">  * 1) first: iteration number for the first snapshot</span>
<span class="sd">  * 2) repetition: number of iterations between snapshots</span>
<span class="sd">  * 3) interpolate:</span>
<span class="sd">  </span>
<span class="sd">    * If set to 1 : the H field samples are interpolated to give the value at the plane of the E field nodes</span>
<span class="sd">    * If set to 2 : as above but the field values are multiplied by the area of the cell on the plane and interpolated</span>
<span class="sd">      to the centre of the square in the plane of the E field nodes..</span>
<span class="sd">    * If set to 3 : as above but the order of the field components in the output file is changed so that for the x,y</span>
<span class="sd">      and z planes the order is (yzx), (zxy) and (xyz) respectively instead of always being (xyz)</span>
<span class="sd">    * If set to 4 : as for 2 except that all 3 coordinates are given for each point</span>
<span class="sd">    </span>
<span class="sd">  * 4) real_dft: Set this if it is not required to write the imaginary component to file</span>
<span class="sd">  * 5) mod_only: Write only the modulus to file</span>
<span class="sd">  * 6) mod_all: Write the modulus AND the real and imaginary parts to file</span>
<span class="sd">  * 7) plane: 0=all, 1=x, 2=y, 3=z</span>
<span class="sd">  * 8-13) P1,P2: coordinates of the lower left and top right corners of the plane P1(x1,y1,z1), P2(x2,y2,z2)</span>
<span class="sd">  * 14) frequency_vector: frequency (in MHz! ). Will create a frequency snapshot for each frequency in the list/vector</span>
<span class="sd">  * 15) starting_sample: iteration number at which to start the running fourier transforms</span>
<span class="sd">  * 16-24) E,H,J: field components to be sampled E(Ex,Ey,Ez), H(Hx,Hy,Hz), J(Jx,Jy,Jz)</span>

<span class="sd">  The output file is of the same format as the snapshot list format and the naming is the same except that the time serial number starts at 00&quot; instead of aa.</span>

<span class="sd">  Clarification on how *real_dft*, *mod_only* and *mod_all* work:</span>
<span class="sd">  </span>
<span class="sd">  * if mod_only or mod_all: output mod</span>
<span class="sd">  * if not(mod_only): output real part</span>
<span class="sd">  * if not(real_dft) and not(mod_only): output imaginary part</span>

<span class="sd">  Or in table form:</span>

<span class="sd">  ========  ========  =======  =========  ===========  ===========</span>
<span class="sd">  Inputs                       Output</span>
<span class="sd">  ---------------------------  -----------------------------------</span>
<span class="sd">  real_dft  mod_only  mod_all  \|field\|  real(field)  imag(field)</span>
<span class="sd">  ========  ========  =======  =========  ===========  ===========</span>
<span class="sd">  0         0         0        0          **1**        **1**</span>
<span class="sd">  0         0         **1**    **1**      **1**        **1**</span>
<span class="sd">  0         **1**     0        **1**      0            0    </span>
<span class="sd">  0         **1**     **1**    **1**      0            0    </span>
<span class="sd">  **1**     0         0        0          **1**        0    </span>
<span class="sd">  **1**     0         **1**    **1**      **1**        0    </span>
<span class="sd">  **1**     **1**     0        **1**      0            0    </span>
<span class="sd">  **1**     **1**     **1**    **1**      0            0    </span>
<span class="sd">  ========  ========  =======  =========  ===========  ===========</span>
<span class="sd">  </span>
<span class="sd">  .. note:: J output does not work at the moment. This is a Bristol FDTD related issue.</span>

<span class="sd">  .. todo:: Change frequency_vector to frequency_vector_Mhz?</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">real_dft</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mod_all</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">setFirst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getStartingSample</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRepetition</span><span class="p">())</span> <span class="c1"># crashes if = 0</span>
    <span class="k">return</span>

<div class="viewcode-block" id="FrequencySnapshot.fillData"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.fillData">[docs]</a>  <span class="k">def</span> <span class="nf">fillData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data3D</span><span class="p">,</span> <span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="c1"># FrequencySnapshot data filling</span>
    <span class="c1">#print(&#39;FrequencySnapshot data filling&#39;)</span>
    <span class="c1">#for k in header[2:]:</span>
      <span class="c1">#print(k)</span>
      <span class="c1">#print(row[k])</span>
      <span class="c1">#print(data3D[x_idx, y_idx, z_idx])</span>
      <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;E&#39;])</span>
      <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;H&#39;])</span>
      <span class="c1">#data3D[x_idx, y_idx, z_idx][k] = row[k]</span>
    <span class="c1">#[&#39;Exmod&#39;, &#39;Exre&#39;, &#39;Exim&#39;, &#39;Eymod&#39;, &#39;Eyre&#39;, &#39;Eyim&#39;, &#39;Ezmod&#39;, &#39;Ezre&#39;, &#39;Ezim&#39;, &#39;Hxmod&#39;, &#39;Hxre&#39;, &#39;Hxim&#39;, &#39;Hymod&#39;, &#39;Hyre&#39;, &#39;Hyim&#39;, &#39;Hzmod&#39;, &#39;Hzre&#39;, &#39;Hzim&#39;]</span>
    <span class="c1">#-&gt; E(vec3, complex), H(vec3, complex)</span>
      
    <span class="c1">#print(data3D[x_idx, y_idx, z_idx])</span>
    <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;E&#39;])</span>
    <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;E&#39;][0])</span>
    <span class="c1">#print(row[header.index(&#39;material&#39;)])</span>
    <span class="k">if</span> <span class="s1">&#39;Exre&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Exim&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Exre&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Exim&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Eyre&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Eyim&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Eyre&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Eyim&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Ezre&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Ezim&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Ezre&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Ezim&#39;</span><span class="p">)]</span>

    <span class="k">if</span> <span class="s1">&#39;Hxre&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Hxim&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;H&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hxre&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hxim&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Hyre&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Hyim&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;H&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hyre&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hyim&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Hzre&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Hzim&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;H&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hzre&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hzim&#39;</span><span class="p">)]</span>

    <span class="c1">#data_epsilon[x_idx, y_idx, z_idx][&#39;epsilon&#39;] = row[&#39;material&#39;]</span>
    <span class="c1">#data_epsilon[x_idx, y_idx, z_idx] = row[&#39;material&#39;]</span>

    <span class="k">return</span></div>

<div class="viewcode-block" id="FrequencySnapshot.getFileNames"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.getFileNames">[docs]</a>  <span class="k">def</span> <span class="nf">getFileNames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fsnap_numID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tsnap_numID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">alphaID</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span> <span class="o">=</span> <span class="n">numID_to_alphaID_FrequencySnapshot</span><span class="p">(</span><span class="n">fsnap_numID</span><span class="p">,</span> <span class="n">snap_plane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">(),</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="n">snap_time_number</span><span class="p">)</span>
    <span class="n">fsnap_numID</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">([</span><span class="n">filename</span><span class="p">],</span> <span class="n">fsnap_numID</span><span class="p">,</span> <span class="n">tsnap_numID</span><span class="p">)</span></div>

<div class="viewcode-block" id="FrequencySnapshot.getOutputColumnHeaders"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.getOutputColumnHeaders">[docs]</a>  <span class="k">def</span> <span class="nf">getOutputColumnHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">column_headers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">plane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plane</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">plane</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOutputColumnHeadersSubFunction</span><span class="p">(</span><span class="s1">&#39;Ex&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOutputColumnHeadersSubFunction</span><span class="p">(</span><span class="s1">&#39;Ey&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOutputColumnHeadersSubFunction</span><span class="p">(</span><span class="s1">&#39;Ez&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOutputColumnHeadersSubFunction</span><span class="p">(</span><span class="s1">&#39;Hx&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOutputColumnHeadersSubFunction</span><span class="p">(</span><span class="s1">&#39;Hy&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOutputColumnHeadersSubFunction</span><span class="p">(</span><span class="s1">&#39;Hz&#39;</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">column_headers</span><span class="p">)</span></div>

<div class="viewcode-block" id="FrequencySnapshot.getOutputColumnHeadersSubFunction"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.getOutputColumnHeadersSubFunction">[docs]</a>  <span class="k">def</span> <span class="nf">getOutputColumnHeadersSubFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="n">column_headers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">mod_all</span><span class="p">:</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span> <span class="o">+</span> <span class="s1">&#39;mod&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span><span class="p">):</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span> <span class="o">+</span> <span class="s1">&#39;re&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_dft</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span><span class="p">):</span>
      <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span> <span class="o">+</span> <span class="s1">&#39;im&#39;</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">column_headers</span><span class="p">)</span></div>

<div class="viewcode-block" id="FrequencySnapshot.getStartingSample"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.getStartingSample">[docs]</a>  <span class="k">def</span> <span class="nf">getStartingSample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span></div>
    
<div class="viewcode-block" id="FrequencySnapshot.setStartingSample"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.setStartingSample">[docs]</a>  <span class="k">def</span> <span class="nf">setStartingSample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starting_sample</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">starting_sample</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span> <span class="o">=</span> <span class="n">starting_sample</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span></div>

  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;printing function&#39;&#39;&#39;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;interpolate = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;real_dft = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_dft</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;mod_only = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;mod_all = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mod_all</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;frequency_vector = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;starting_sample = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="FrequencySnapshot.setFromSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.setFromSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_in</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Copies the properties from *snapshot_in*.</span>
<span class="sd">    </span>
<span class="sd">    .. todo:: Use loops over object dirs? Look for existing function in python?</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">)</span>
    <span class="c1"># We check for existing attributes to also enable copying from time/epsilon snapshots for example. Just checking for the type of *snapshot_in* might fail if classes change and is more limiting...</span>
    <span class="k">if</span> <span class="s1">&#39;interpolate&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">interpolate</span>
    <span class="k">if</span> <span class="s1">&#39;real_dft&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_dft</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">real_dft</span>
    <span class="k">if</span> <span class="s1">&#39;mod_only&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">mod_only</span>
    <span class="k">if</span> <span class="s1">&#39;mod_all&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">mod_all</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">mod_all</span>
    <span class="k">if</span> <span class="s1">&#39;frequency_vector&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">frequency_vector</span>
    <span class="k">if</span> <span class="s1">&#39;starting_sample&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">starting_sample</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="FrequencySnapshot.read_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.read_entry">[docs]</a>  <span class="k">def</span> <span class="nf">read_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]));</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]));</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">real_dft</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mod_all</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setPlaneBfdtdIndex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">])));</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>    
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">])];</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="FrequencySnapshot.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;.. todo:: mesh argument not used yet. Remove? Use explicit snap function instead? With snap by default if desired?&#39;&#39;&#39;</span>

    <span class="c1">#print(&#39;FrequencySnapshot.write_entry&#39;)</span>

    <span class="c1">#print(self)</span>
    <span class="c1">#print(FILE)</span>
    <span class="c1">#print(mesh)</span>
    <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getExtension</span><span class="p">()</span>
    <span class="n">plane_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneBfdtdIndex</span><span class="p">()</span>
    <span class="n">plane_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">()</span>
  
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_extension_bool</span><span class="p">:</span>
      <span class="n">S</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getSizeAndResolution</span><span class="p">()</span>
      <span class="n">centro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCentro</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">plane_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="n">centro</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">centro</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
      <span class="k">elif</span> <span class="n">plane_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">centro</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centro</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">centro</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">centro</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRepetition</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;self.getRepetition() = </span><span class="si">{}</span><span class="s1"> &lt;= 0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRepetition</span><span class="p">()))</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">frequency</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span><span class="p">):</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;FREQUENCY_SNAPSHOT **name=&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **FIRST</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **REPETITION</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **interpolate?</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **REAL DFT</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_dft</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **MOD ONLY</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">mod_only</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **MOD ALL</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">mod_all</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **PLANE </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plane_ID</span><span class="p">,</span> <span class="n">plane_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **X1</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Y1</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Z1</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **X2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Y2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Z2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.8E}</span><span class="s2"> **FREQUENCY (MHz if dimensions in mum) (c0/f = </span><span class="si">{:E}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">get_c0</span><span class="p">()</span><span class="o">/</span><span class="n">frequency</span><span class="p">))</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **STARTING SAMPLE</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">starting_sample</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **EX</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **EY</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **EZ</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **HX</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **HY</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **HZ</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **JX</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **JY</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **JZ</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>
  
      <span class="c1">#if self.P1[plane_ID-1] == self.P2[plane_ID-1]:</span>
        <span class="c1">#snapshot(self.name, plane_ID, self.P1, self.P2, self.frequency_vector[i])</span>
      <span class="c1">#else:</span>
        <span class="c1">#snapshot(self.name + &#39; X-&#39;, 1, [self.P1[0], self.P1[1], self.P1[2]], [self.P1[0], self.P2[1], self.P2[2]], self.frequency_vector[i])</span>
        <span class="c1">#snapshot(self.name + &#39; X+&#39;, 1, [self.P2[0], self.P1[1], self.P1[2]], [self.P2[0], self.P2[1], self.P2[2]], self.frequency_vector[i])</span>
        <span class="c1">#snapshot(self.name + &#39; Y-&#39;, 2, [self.P1[0], self.P1[1], self.P1[2]], [self.P2[0], self.P1[1], self.P2[2]], self.frequency_vector[i])</span>
        <span class="c1">#snapshot(self.name + &#39; Y+&#39;, 2, [self.P1[0], self.P2[1], self.P1[2]], [self.P2[0], self.P2[1], self.P2[2]], self.frequency_vector[i])</span>
        <span class="c1">#snapshot(self.name + &#39; Z-&#39;, 3, [self.P1[0], self.P1[1], self.P1[2]], [self.P2[0], self.P2[1], self.P1[2]], self.frequency_vector[i])</span>
        <span class="c1">#snapshot(self.name + &#39; Z+&#39;, 3, [self.P1[0], self.P1[1], self.P2[2]], [self.P2[0], self.P2[1], self.P2[2]], self.frequency_vector[i])</span>

<div class="viewcode-block" id="FrequencySnapshot.getLambda"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.getLambda">[docs]</a>  <span class="k">def</span> <span class="nf">getLambda</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get the wavelength list.</span>
<span class="sd">    </span>
<span class="sd">    .. todo:: Rename to getWavelength()?</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">get_c0</span><span class="p">()</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="FrequencySnapshot.setWavelengths"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.setWavelengths">[docs]</a>  <span class="k">def</span> <span class="nf">setWavelengths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength_vector</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wavelength_vector</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
      <span class="n">wavelength_vector</span> <span class="o">=</span> <span class="p">[</span><span class="n">wavelength_vector</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setFrequencies</span><span class="p">([</span><span class="n">get_c0</span><span class="p">()</span><span class="o">/</span><span class="n">L</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">wavelength_vector</span><span class="p">])</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="FrequencySnapshot.getFrequencies"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.getFrequencies">[docs]</a>  <span class="k">def</span> <span class="nf">getFrequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span><span class="p">)</span></div>

<div class="viewcode-block" id="FrequencySnapshot.setFrequencies"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.setFrequencies">[docs]</a>  <span class="k">def</span> <span class="nf">setFrequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency_vector</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Set the frequencies of the frequency snapshot.</span>
<span class="sd">    </span>
<span class="sd">    .. todo:: setWavelength/Lambda functions? -&gt; wavelength is clearer -&gt; update all similar calls (ex: excitation)</span>
<span class="sd">    .. todo:: Support list and single item? Is that even good design? -&gt; Probably not. Would be better to support multiple args and use arg unpacking. -&gt; Make sure to update all other uses before doing this. Significant change.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">frequency_vector</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frequency_vector</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span> <span class="o">=</span> <span class="p">[</span><span class="n">frequency_vector</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_vector</span> <span class="o">=</span> <span class="n">frequency_vector</span>
    <span class="k">return</span></div>
  
<div class="viewcode-block" id="FrequencySnapshot.write_data_row"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.FrequencySnapshot.write_data_row">[docs]</a>  <span class="k">def</span> <span class="nf">write_data_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvwriter</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>

    <span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span> <span class="o">=</span> <span class="n">sampling_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">row_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">if</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">if</span> <span class="s1">&#39;z&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>

    <span class="k">if</span> <span class="s1">&#39;Exmod&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Exmod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;Exre&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Exre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="s1">&#39;Exim&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Exim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>
    <span class="k">if</span> <span class="s1">&#39;Eymod&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Eymod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;Eyre&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Eyre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="s1">&#39;Eyim&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Eyim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>
    <span class="k">if</span> <span class="s1">&#39;Ezmod&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Ezmod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;Ezre&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Ezre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="s1">&#39;Ezim&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Ezim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>

    <span class="k">if</span> <span class="s1">&#39;Hxmod&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hxmod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;Hxre&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hxre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="s1">&#39;Hxim&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hxim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>
    <span class="k">if</span> <span class="s1">&#39;Hymod&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hymod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;Hyre&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hyre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="s1">&#39;Hyim&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hyim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>
    <span class="k">if</span> <span class="s1">&#39;Hzmod&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hzmod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;Hzre&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hzre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="s1">&#39;Hzim&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hzim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>

    <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row_dict</span><span class="p">)</span>

    <span class="k">return</span></div></div>

<div class="viewcode-block" id="TimeSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot">[docs]</a><span class="k">class</span> <span class="nc">TimeSnapshot</span><span class="p">(</span><span class="n">Snapshot</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Simple base class for all single-entry BFDTD snapshots written as *SNAPSHOT* in .inp files.</span>
<span class="sd">  </span>
<span class="sd">  Attributes:</span>
<span class="sd">  </span>
<span class="sd">    * power: 0 or 1</span>
<span class="sd">    * epsilon: 0 or 1</span>

<span class="sd">  One or more field components may be sampled over a specified plane in the structure after a specified number of iterations.</span>
<span class="sd">  It is possible to take snapshots after every n iterations by setting the iterations between snapshots parameter to n.</span>
<span class="sd">  </span>
<span class="sd">  For each snapshot requested a file is produced in one of two formats:</span>
<span class="sd">  </span>
<span class="sd">  * List format which has a filename of the form x1idaa.prn, where x is the plane over</span>
<span class="sd">    which the snapshot has been taken, 1&quot;is the snapshot serial number. ie. the snaps are numbered in the order which</span>
<span class="sd">    they appear in the input file.. id in an identifier specified in the flags object. aa&quot; is the time serial number ie.</span>
<span class="sd">    if snapshots are asked for at every 100 iterations then the first one will have aa, the second one ab&quot; etc</span>
<span class="sd">    The file consists of a single header line followed by columns of numbers, one for each field component wanted and</span>
<span class="sd">    two for the coordinates of the point which has been sampled. These files can be read into Gema.</span>
<span class="sd">  </span>
<span class="sd">  * Matrix format for each snapshot a file is produced for each requested field component with a name of the form</span>
<span class="sd">    x1idaa_ex where the ex is the field component being sampled. The rest of the filename is tha same as for the list</span>
<span class="sd">    format case. The file consists of a matrix of numbers the first column and first row or which, gives the position of</span>
<span class="sd">    the sample points in each direction. These files can be read into MathCad or to spreadsheet programs.</span>
<span class="sd">  </span>
<span class="sd">  The format of the snapshot object is as follows:</span>
<span class="sd">  </span>
<span class="sd">    * 1 : first: iteration number for the first snapshot</span>
<span class="sd">    * 2 : repetition: number of iterations between snapshots</span>
<span class="sd">    * 3 : plane: 1=x,2=y,3=z</span>
<span class="sd">    * 4-9 : P1, P2: coordinates of the lower left and top right corners of the plane P1(x1,y1,z1), P2(x2,y2,z2)</span>
<span class="sd">    * 10-18 : E, H, J: field components to be sampled E(Ex,Ey,Ez), H(Hx,Hy,Hz), J(Jx,Jy,Jz)</span>
<span class="sd">    * 19 : power: print power? =0/1</span>
<span class="sd">    * 20 : eps: create EPS (-&gt;epsilon-&gt;refractive index) snapshot? =0/1</span>
<span class="sd">    * 21 : ???: write an output file in list format (NOT IMPLEMENTED YET)(default is list format)</span>
<span class="sd">    * 22 : ???: write an output file in matrix format (NOT IMPLEMENTED YET)</span>
<span class="sd">  </span>
<span class="sd">  Mode filtered probe files (Requires a template for the first excitation object!):</span>
<span class="sd">  </span>
<span class="sd">    Mode filtered probe files are specified in the same way as a snapshot across the reference plane except that no field components are selected, i.e. E=H=J=power=eps=(0,0,0).</span>
<span class="sd">    In addition, the &quot;repetition&quot; parameter takes the role which the &quot;step&quot; parameter does on normal probes.</span>
<span class="sd">    </span>
<span class="sd">    The output will have the same form as a probe file and will consist of the inner product at each time step of the field distribution across the reference plane with the template specified for the first excitation object.</span>
<span class="sd">    This template will normally be the wanted mode of the guiding structure and, thus, the output of this probe will be the amplitude of just this mode.</span>

<span class="sd">    The effect of this is that the amplitude of the mode of interest is sampled across the whole waveguide cross-section.</span>
<span class="sd">    If a normal field probe had been used, then the unwanted effects of other modes would cause inaccuracies in the final result.</span>

<span class="sd">  .. note:: JX,JY,JZ output does not seem to work. (Bristol FDTD issue)</span>
<span class="sd">  </span>
<span class="sd">  The output columns are (assuming all columns were enabled):</span>
<span class="sd">  </span>
<span class="sd">    * For X planes::</span>
<span class="sd">            </span>
<span class="sd">        #y z Ex Ey Ez Hx Hy Hz Pow material </span>
<span class="sd">      </span>
<span class="sd">    * For Y planes::</span>
<span class="sd">    </span>
<span class="sd">        #x z Ex Ey Ez Hx Hy Hz Pow material </span>
<span class="sd">      </span>
<span class="sd">    * For Z planes::</span>
<span class="sd">    </span>
<span class="sd">        #x y Ex Ey Ez Hx Hy Hz Pow material </span>

<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">TimeSnapshot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span> <span class="c1"># python 2+3 compatible super() call</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span>

  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;printing function&#39;&#39;&#39;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;power = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;eps = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="TimeSnapshot.fillData"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.fillData">[docs]</a>  <span class="k">def</span> <span class="nf">fillData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data3D</span><span class="p">,</span> <span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="c1"># TimeSnapshot data filling</span>
    <span class="c1">#print(&#39;TimeSnapshot data filling&#39;)</span>
    <span class="c1">#for k in header[2:]:</span>
      <span class="c1">#print(k)</span>
      <span class="c1">#print(row[k])</span>
      <span class="c1">#print(data3D[x_idx, y_idx, z_idx])</span>
      <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;E&#39;])</span>
      <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;H&#39;])</span>
      <span class="c1">#data3D[x_idx, y_idx, z_idx][k] = row[k]</span>
      <span class="c1">#[&#39;Ex&#39;, &#39;Ey&#39;, &#39;Ez&#39;, &#39;Hx&#39;, &#39;Hy&#39;, &#39;Hz&#39;, &#39;Pow&#39;, &#39;material&#39;]</span>
      <span class="c1">#-&gt; E(vec3, float), H(vec3, float), Pow(float), material(float)</span>
      
    <span class="c1">#print(data3D[x_idx, y_idx, z_idx])</span>
    <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;E&#39;])</span>
    <span class="c1">#print(data3D[x_idx, y_idx, z_idx][&#39;E&#39;][0])</span>
    <span class="c1">#print(row[header.index(&#39;material&#39;)])</span>
    <span class="k">if</span> <span class="s1">&#39;Ex&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Ex&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Ey&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Ey&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Ez&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Ez&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Hx&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;H&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hx&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Hy&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;H&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hy&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Hz&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;H&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Hz&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;Pow&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;Pow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;Pow&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s1">&#39;material&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span> <span class="n">data3D</span><span class="p">[</span><span class="n">x_idx</span><span class="p">,</span> <span class="n">y_idx</span><span class="p">,</span> <span class="n">z_idx</span><span class="p">][</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;material&#39;</span><span class="p">)]</span>

    <span class="c1">#data_epsilon[x_idx, y_idx, z_idx][&#39;epsilon&#39;] = row[&#39;material&#39;]</span>
    <span class="c1">#data_epsilon[x_idx, y_idx, z_idx] = row[&#39;material&#39;]</span>

    <span class="k">return</span></div>

<div class="viewcode-block" id="TimeSnapshot.getOutputColumnHeaders"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.getOutputColumnHeaders">[docs]</a>  <span class="k">def</span> <span class="nf">getOutputColumnHeaders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTypeBasedOnAttributes</span><span class="p">()</span> <span class="o">==</span> <span class="n">ModeFilteredProbe</span><span class="p">:</span>
      <span class="n">column_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;inner_product_e&#39;</span><span class="p">,</span> <span class="s1">&#39;inner_product_h&#39;</span><span class="p">,</span> <span class="s1">&#39;inner_product_poynting&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;difference&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">column_headers</span> <span class="o">=</span> <span class="p">[]</span>
      
      <span class="n">plane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">plane</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
      <span class="k">elif</span> <span class="n">plane</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
      
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Ex&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Ey&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Ez&#39;</span><span class="p">)</span>
      
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Hx&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Hy&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Hz&#39;</span><span class="p">)</span>
      
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPower</span><span class="p">():</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Pow&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getEpsilon</span><span class="p">():</span>
        <span class="n">column_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;material&#39;</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">column_headers</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeSnapshot.getPower"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.getPower">[docs]</a>  <span class="k">def</span> <span class="nf">getPower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeSnapshot.setPower"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.setPower">[docs]</a>  <span class="k">def</span> <span class="nf">setPower</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">power</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="TimeSnapshot.getEpsilon"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.getEpsilon">[docs]</a>  <span class="k">def</span> <span class="nf">getEpsilon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeSnapshot.setEpsilon"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.setEpsilon">[docs]</a>  <span class="k">def</span> <span class="nf">setEpsilon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eps</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeSnapshot.getTypeBasedOnAttributes"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.getTypeBasedOnAttributes">[docs]</a>  <span class="k">def</span> <span class="nf">getTypeBasedOnAttributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the &quot;type&quot; of the snapshot based on the selected output columns (E, H, J, power and epsilon).</span>
<span class="sd">    </span>
<span class="sd">    * If all output columns are disabled: ModeFilteredProbe</span>
<span class="sd">    * If all output columns are disabled, except epsilon: EpsilonSnapshot</span>
<span class="sd">    * Else: TimeSnapshot</span>

<span class="sd">    Or in table form:</span>

<span class="sd">    ==========  ========  =======  =========  ===========  =================</span>
<span class="sd">    Attributes                                             Output</span>
<span class="sd">    -----------------------------------------------------  -----------------</span>
<span class="sd">    E           H         J        Power      Epsilon      Type</span>
<span class="sd">    ==========  ========  =======  =========  ===========  =================</span>
<span class="sd">    000         000       000      0          0            ModeFilteredProbe</span>
<span class="sd">    000         000       000      0          1            EpsilonSnapshot</span>
<span class="sd">    \*          \*        \*       \*         \*           TimeSnapshot</span>
<span class="sd">    ==========  ========  =======  =========  ===========  =================</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getEfield</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHfield</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getJfield</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPower</span><span class="p">())</span> <span class="o">==</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getEpsilon</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ModeFilteredProbe</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">EpsilonSnapshot</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">TimeSnapshot</span>
    
    <span class="k">return</span></div>

<div class="viewcode-block" id="TimeSnapshot.getFileNames"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.getFileNames">[docs]</a>  <span class="k">def</span> <span class="nf">getFileNames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fsnap_numID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tsnap_numID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTypeBasedOnAttributes</span><span class="p">()</span> <span class="o">==</span> <span class="n">ModeFilteredProbe</span><span class="p">:</span>
      <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">alphaID</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span> <span class="o">=</span> <span class="n">numID_to_alphaID_ModeFilteredProbe</span><span class="p">(</span><span class="n">tsnap_numID</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="n">snap_time_number</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># Note the +1 in indexing for snap_time_number. BFDTD inconsistencies...</span>
      <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">alphaID</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span> <span class="o">=</span> <span class="n">numID_to_alphaID_TimeSnapshot</span><span class="p">(</span><span class="n">tsnap_numID</span><span class="p">,</span> <span class="n">snap_plane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">(),</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="n">snap_time_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">tsnap_numID</span> <span class="o">+=</span> <span class="mi">1</span>    
    <span class="k">return</span> <span class="p">([</span><span class="n">filename</span><span class="p">],</span> <span class="n">fsnap_numID</span><span class="p">,</span> <span class="n">tsnap_numID</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeSnapshot.read_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.read_entry">[docs]</a>  <span class="k">def</span> <span class="nf">read_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]));</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]));</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setPlaneBfdtdIndex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">])));</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>    
    <span class="bp">self</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;</span><span class="n">idx</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]));</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeSnapshot.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1">#print(&#39;TimeSnapshot.write_entry&#39;)</span>
    
    <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getExtension</span><span class="p">()</span>
    <span class="n">plane_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneBfdtdIndex</span><span class="p">()</span>
    <span class="n">plane_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">()</span>
  
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_extension_bool</span><span class="p">:</span>
      <span class="n">S</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getSizeAndResolution</span><span class="p">()</span>
      <span class="n">centro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCentro</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">plane_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="n">centro</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">centro</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
      <span class="k">elif</span> <span class="n">plane_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">centro</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centro</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">centro</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">centro</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
  
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SNAPSHOT **name=&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **FIRST</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **REPETITION</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:d}</span><span class="s2"> **PLANE </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plane_ID</span><span class="p">,</span> <span class="n">plane_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **X1</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Y1</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Z1</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **X2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Y2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Z2</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">P2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **EX</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **EY</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **EZ</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **HX</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **HY</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **HZ</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **JX</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **JY</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **JZ</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **POW</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> **EPS</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">return</span></div>
  
    <span class="c1">#if self.P1[plane_ID-1] == self.P2[plane_ID-1]:</span>
      <span class="c1">#snapshot(plane_ID, self.P1, self.P2, self.name)</span>
      <span class="c1">##raise Exception(&#39;self.P1 = {}, self.P2 = {}, plane_ID={}, plane_name={}&#39;.format(self.P1, self.P2, plane_ID, plane_name))</span>
    <span class="c1">#else:</span>
      <span class="c1">#snapshot(1, [self.P1[0], self.P1[1], self.P1[2]], [self.P1[0], self.P2[1], self.P2[2]], self.name + &#39; X-&#39;)</span>
      <span class="c1">#snapshot(1, [self.P2[0], self.P1[1], self.P1[2]], [self.P2[0], self.P2[1], self.P2[2]], self.name + &#39; X+&#39;)</span>
      <span class="c1">#snapshot(2, [self.P1[0], self.P1[1], self.P1[2]], [self.P2[0], self.P1[1], self.P2[2]], self.name + &#39; Y-&#39;)</span>
      <span class="c1">#snapshot(2, [self.P1[0], self.P2[1], self.P1[2]], [self.P2[0], self.P2[1], self.P2[2]], self.name + &#39; Y+&#39;)</span>
      <span class="c1">#snapshot(3, [self.P1[0], self.P1[1], self.P1[2]], [self.P2[0], self.P2[1], self.P1[2]], self.name + &#39; Z-&#39;)</span>
      <span class="c1">#snapshot(3, [self.P1[0], self.P1[1], self.P2[2]], [self.P2[0], self.P2[1], self.P2[2]], self.name + &#39; Z+&#39;)</span>
  
<div class="viewcode-block" id="TimeSnapshot.write_data_row"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshot.write_data_row">[docs]</a>  <span class="k">def</span> <span class="nf">write_data_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvwriter</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    .. todo:: Add support for power and ModeFilteredProbe columns.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span> <span class="o">=</span> <span class="n">sampling_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">row_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">if</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">if</span> <span class="s1">&#39;z&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>

    <span class="k">if</span> <span class="s1">&#39;Ex&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;Ey&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Ey&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;Ez&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Ez&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;Hx&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;Hy&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;Hz&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;Hz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;material&#39;</span> <span class="ow">in</span> <span class="n">csvwriter</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">:</span> <span class="n">row_dict</span><span class="p">[</span><span class="s1">&#39;material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsilon</span>

    <span class="n">csvwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row_dict</span><span class="p">)</span>

    <span class="k">return</span></div></div>

<div class="viewcode-block" id="EpsilonSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EpsilonSnapshot">[docs]</a><span class="k">class</span> <span class="nc">EpsilonSnapshot</span><span class="p">(</span><span class="n">TimeSnapshot</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Child class of :py:class:`TimeSnapshot`, which disables all output columns except epsilon.</span>

<span class="sd">  .. todo:: Get rid of this class? It is possible to output E,H,J, power and eps with the same snapshot, i.e. an epsilon snapshot is not that special compared to a time snapshot... (apart from not changing in time)</span>
<span class="sd">  </span>
<span class="sd">  .. todo:: It might be possible to set the repetition to flag.iterations(+1?) on write instead of simply using a very large repetition number?</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDefaults</span><span class="p">()</span>
    <span class="k">return</span>

<div class="viewcode-block" id="EpsilonSnapshot.setDefaults"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EpsilonSnapshot.setDefaults">[docs]</a>  <span class="k">def</span> <span class="nf">setDefaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Sets the following properties:</span>
<span class="sd">    </span>
<span class="sd">    * self.E = [0,0,0]</span>
<span class="sd">    * self.H = [0,0,0]</span>
<span class="sd">    * self.J = [0,0,0]</span>
<span class="sd">    * self.power = 0</span>
<span class="sd">    * self.eps = 1</span>
<span class="sd">    * self.first = 1</span>
<span class="sd">    * self.repetition = int(1e9)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># to make it output epsilon only</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># to get a single snapshot directly at the start</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># crashes if = 0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repetition</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span> <span class="c1"># We just set this to an insanely high number by default in case the user forgets to set it. (TODO: Maybe something like -1 works. Check BFDTD manual.)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="EpsilonSnapshot.setFromSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EpsilonSnapshot.setFromSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_in</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Copies the properties from *snapshot_in*, but then calls :py:func:`EpsilonSnapshot.setDefaults`.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDefaults</span><span class="p">()</span>
    <span class="k">return</span></div></div>

<div class="viewcode-block" id="ModeFilteredProbe"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeFilteredProbe">[docs]</a><span class="k">class</span> <span class="nc">ModeFilteredProbe</span><span class="p">(</span><span class="n">TimeSnapshot</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Child class of *TimeSnapshot*, which disables all output columns. This leads to a *mode filtered probe* behaviour.</span>
<span class="sd">  </span>
<span class="sd">  Unlike usual time and epsilon snapshots, the ModeFilteredProbe output filenames start with &quot;i&quot; instead of &quot;x/y/z&quot; and start with a 0 index instead of 1, i.e. the first ModeFilteredProbe output file will be &quot;i1_id_00.prn&quot; instead of &quot;x1_id_01.prn&quot;.</span>
<span class="sd">  </span>
<span class="sd">  Requires a &quot;template&quot;. The default template filename is &quot;template.int&quot;.</span>
<span class="sd">  </span>
<span class="sd">  The output columns are always::</span>

<span class="sd">    #Time inner_product_e inner_product_h inner_product_poynting sum difference</span>

<span class="sd">  .. todo:: Understand and explain what is output into the files...</span>
<span class="sd">  .. todo:: Add template filename attribute...</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="SnapshotBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox">[docs]</a><span class="k">class</span> <span class="nc">SnapshotBox</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;A base class representing a snapshot box instead of a snapshot plane like the **Snapshot** class.</span>
<span class="sd">  </span>
<span class="sd">  It has one attribute:</span>
<span class="sd">    * baseSnapshot</span>
<span class="sd">  </span>
<span class="sd">  Its purpose is to be used by child classes implementing a **write_entry** function, which will write snapshot planes based on **baseSnapshot** in various ways.</span>

<span class="sd">  .. todo:: add name prefix? Or append to base snapshot name?</span>
<span class="sd">  .. todo:: At the moment, this class and its children do not have their own location/size/orientation info, taking it from the base snapshot instead.</span>
<span class="sd">            This means that one cannot do this::</span>

<span class="sd">              xyz=SnapshotBoxXYZ()</span>
<span class="sd">              xyz.setSize/LocationOrientation</span>
<span class="sd">              xyz.base=eps</span>
<span class="sd">              write</span>
<span class="sd">              xyz.base=fsnap</span>
<span class="sd">              write</span>
<span class="sd">              etc.</span>

<span class="sd">            Instead location/size/orientation have to be set for each base snapshot passed.</span>
<span class="sd">            Change system?</span>
<span class="sd">            **Allowing set functions for those properties in here can be misleading, since they actually modify the base snapshot!!!**</span>
<span class="sd">            **If the base snapshot is changed, they are lost!**</span>
<span class="sd">            What is the best solution?</span>
<span class="sd">            Should this class be a subclass of Snapshot?</span>
<span class="sd">  &#39;&#39;&#39;</span>
  
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span> <span class="o">=</span> <span class="n">EpsilonSnapshot</span><span class="p">()</span>

<div class="viewcode-block" id="SnapshotBox.getName"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.getName">[docs]</a>  <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBaseSnapshot</span><span class="p">()</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span></div>

<div class="viewcode-block" id="SnapshotBox.setBaseSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.setBaseSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">setBaseSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseSnapshot</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span> <span class="o">=</span> <span class="n">baseSnapshot</span></div>

<div class="viewcode-block" id="SnapshotBox.getBaseSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.getBaseSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">getBaseSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span></div>
    
<div class="viewcode-block" id="SnapshotBox.setExtension"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.setExtension">[docs]</a>  <span class="k">def</span> <span class="nf">setExtension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerCorner_vec3</span><span class="p">,</span> <span class="n">upperCorner_vec3</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">setExtension</span><span class="p">(</span><span class="n">lowerCorner_vec3</span><span class="p">,</span> <span class="n">upperCorner_vec3</span><span class="p">)</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="SnapshotBox.getExtension"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.getExtension">[docs]</a>  <span class="k">def</span> <span class="nf">getExtension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getExtension</span><span class="p">()</span></div>

<div class="viewcode-block" id="SnapshotBox.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;This function has to be implemented by child classes.&#39;</span><span class="p">)</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="SnapshotBox.setStartingSample"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.setStartingSample">[docs]</a>  <span class="k">def</span> <span class="nf">setStartingSample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starting_sample</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">getBaseSnapshot</span><span class="p">()</span><span class="o">.</span><span class="n">setStartingSample</span><span class="p">(</span><span class="n">starting_sample</span><span class="p">)</span></div>
<div class="viewcode-block" id="SnapshotBox.setFirst"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.setFirst">[docs]</a>  <span class="k">def</span> <span class="nf">setFirst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starting_sample</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">getBaseSnapshot</span><span class="p">()</span><span class="o">.</span><span class="n">setFirst</span><span class="p">(</span><span class="n">starting_sample</span><span class="p">)</span></div>
<div class="viewcode-block" id="SnapshotBox.setRepetition"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBox.setRepetition">[docs]</a>  <span class="k">def</span> <span class="nf">setRepetition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starting_sample</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">getBaseSnapshot</span><span class="p">()</span><span class="o">.</span><span class="n">setRepetition</span><span class="p">(</span><span class="n">starting_sample</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="SnapshotBoxXYZ"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxXYZ">[docs]</a><span class="k">class</span> <span class="nc">SnapshotBoxXYZ</span><span class="p">(</span><span class="n">SnapshotBox</span><span class="p">):</span>
  
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="c1">#self.baseSnapshot = EpsilonSnapshot()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sides</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># x,y,z</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span>

<div class="viewcode-block" id="SnapshotBoxXYZ.getIntersectionPoint"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxXYZ.getIntersectionPoint">[docs]</a>  <span class="k">def</span> <span class="nf">getIntersectionPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span></div>
    
<div class="viewcode-block" id="SnapshotBoxXYZ.setIntersectionPoint"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxXYZ.setIntersectionPoint">[docs]</a>  <span class="k">def</span> <span class="nf">setIntersectionPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="SnapshotBoxXYZ.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxXYZ.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">added_snapshots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getCentro</span><span class="p">()</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getExtension</span><span class="p">()</span>
    <span class="n">snapshot_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>

    <span class="n">snapshot_x</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_x</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
    <span class="n">snapshot_x</span><span class="o">.</span><span class="n">setExtensionX</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">snapshot_x</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_x</span><span class="p">)</span>
    
    <span class="n">snapshot_y</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_y</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
    <span class="n">snapshot_y</span><span class="o">.</span><span class="n">setExtensionY</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">snapshot_y</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_y</span><span class="p">)</span>

    <span class="n">snapshot_z</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_z</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span>
    <span class="n">snapshot_z</span><span class="o">.</span><span class="n">setExtensionZ</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersection_point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">snapshot_z</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_z</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">added_snapshots</span></div></div>

<div class="viewcode-block" id="SnapshotBoxSurface"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxSurface">[docs]</a><span class="k">class</span> <span class="nc">SnapshotBoxSurface</span><span class="p">(</span><span class="n">SnapshotBox</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  A utility class to easily create 6 snapshots on the surface of a box.</span>
<span class="sd">  </span>
<span class="sd">  Dilemma:</span>
<span class="sd">    * create boxsurface, boxvolume, etc classes which then write various snapshot types</span>
<span class="sd">    * or different snapshot types, which can then be written using boxsurface, boxvolume, etc writing functions?</span>
<span class="sd">  </span>
<span class="sd">  |  Solution 1 seems better. One or more snapshot classes could be passed to the writing function or as attribute...</span>
<span class="sd">  |  Also writing functions are more likely to increase, compared to the relatively static BFDTD.</span>
<span class="sd">  |  And if BFDTD does add new snapshot types, we should be able to derive them relatively easily from the base classes.</span>
<span class="sd">  |  Base classes should remain as simple as possible.</span>
<span class="sd">    </span>
<span class="sd">  |  problem: redefining all attributes and passing them...</span>
<span class="sd">  |  Maybe we should still go with including functions in the base Snapshot class?</span>
<span class="sd">  |  No, just inherit from Snapshot and redefine the writing function.</span>
<span class="sd">  |  But how to deal with the different types of snapshots?</span>
<span class="sd">  |  This would mean N*M classes for N snapshots and M writing methods.</span>
<span class="sd">  |  Better to pass a prepared snapshot to the writing classes, leading to N+M classes, but allowing for the same N*M behaviours!</span>
<span class="sd">    </span>
<span class="sd">  |  Snapping to the mesh should be done by the user outside this module.</span>
<span class="sd">  |  This gives more flexibility while keeping this module simple.</span>
<span class="sd">  |  Some utilities for snapping already exist ion the mesh class or elsewhere and more can be added.</span>
<span class="sd">  |  Once the meshing system is properly developed, all objects can easily access such functions to snap to the mesh or other similar operations. (ex: 50 snaps, but all on mesh, centered on snap i...)</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="c1">#self.baseSnapshot = EpsilonSnapshot()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sides</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># x-,x+,y-,y+,z-,z+</span>
    <span class="k">return</span>
  
<div class="viewcode-block" id="SnapshotBoxSurface.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxSurface.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">added_snapshots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getExtension</span><span class="p">()</span>
    <span class="n">snapshot_centro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getCentro</span><span class="p">()</span>
    <span class="n">snapshot_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>

    <span class="n">snapshot_x_lower</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_x_lower</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
    <span class="n">snapshot_x_lower</span><span class="o">.</span><span class="n">setExtensionX</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">snapshot_x_lower</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_x_lower</span><span class="p">)</span>

    <span class="n">snapshot_x_upper</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_x_upper</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
    <span class="n">snapshot_x_upper</span><span class="o">.</span><span class="n">setExtensionX</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">snapshot_x_upper</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_x_upper</span><span class="p">)</span>

    <span class="n">snapshot_y_lower</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_y_lower</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
    <span class="n">snapshot_y_lower</span><span class="o">.</span><span class="n">setExtensionY</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">snapshot_y_lower</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_y_lower</span><span class="p">)</span>

    <span class="n">snapshot_y_upper</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_y_upper</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
    <span class="n">snapshot_y_upper</span><span class="o">.</span><span class="n">setExtensionY</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">snapshot_y_upper</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_y_upper</span><span class="p">)</span>

    <span class="n">snapshot_z_lower</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_z_lower</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span>
    <span class="n">snapshot_z_lower</span><span class="o">.</span><span class="n">setExtensionZ</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">snapshot_z_lower</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_z_lower</span><span class="p">)</span>

    <span class="n">snapshot_z_upper</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
    <span class="n">snapshot_z_upper</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span>
    <span class="n">snapshot_z_upper</span><span class="o">.</span><span class="n">setExtensionZ</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">snapshot_z_upper</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot_z_upper</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">added_snapshots</span></div></div>
    
<div class="viewcode-block" id="SnapshotBoxVolume"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxVolume">[docs]</a><span class="k">class</span> <span class="nc">SnapshotBoxVolume</span><span class="p">(</span><span class="n">SnapshotBox</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;Fill the volume corresponding to the box defined by (P1,P2) with snapshots based on the given baseSnapshot.&#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="c1">#self.baseSnapshot = EpsilonSnapshot()</span>

  <span class="c1">#def setBaseSnapshot(self, baseSnapshot):</span>
    <span class="c1">#self.baseSnapshot = baseSnapshot</span>

  <span class="c1">#def getBaseSnapshot(self):</span>
    <span class="c1">#return self.baseSnapshot</span>
    
  <span class="c1">#def setExtension(self, lowerCorner_vec3, upperCorner_vec3):</span>
    <span class="c1">#self.baseSnapshot.setExtension(lowerCorner_vec3, upperCorner_vec3)</span>
    <span class="c1">#return</span>
    
  <span class="c1">#def getExtension(self):</span>
    <span class="c1">#return self.baseSnapshot.getExtension()</span>

  <span class="c1"># these are not in the base class, because XYZ and surface boxes do not need them.</span>
<div class="viewcode-block" id="SnapshotBoxVolume.setPlaneOrientationX"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxVolume.setPlaneOrientationX">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneOrientationX</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">setPlaneOrientationX</span><span class="p">()</span></div>
<div class="viewcode-block" id="SnapshotBoxVolume.setPlaneOrientationY"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxVolume.setPlaneOrientationY">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneOrientationY</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">setPlaneOrientationY</span><span class="p">()</span></div>
<div class="viewcode-block" id="SnapshotBoxVolume.setPlaneOrientationZ"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxVolume.setPlaneOrientationZ">[docs]</a>  <span class="k">def</span> <span class="nf">setPlaneOrientationZ</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">setPlaneOrientationZ</span><span class="p">()</span></div>

<div class="viewcode-block" id="SnapshotBoxVolume.setupSnapshots"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxVolume.setupSnapshots">[docs]</a>  <span class="k">def</span> <span class="nf">setupSnapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">mesh</span> <span class="o">=</span> <span class="n">MeshObject</span><span class="p">()</span>

    <span class="n">added_snapshots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getExtension</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
      <span class="n">position_list</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getXmesh</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">position_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">position</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
          <span class="n">snapshot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
          <span class="n">snapshot</span><span class="o">.</span><span class="n">setExtension</span><span class="p">([</span><span class="n">position</span><span class="p">,</span> <span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                                <span class="p">[</span><span class="n">position</span><span class="p">,</span> <span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
          <span class="c1">#snapshot.write_entry(FILE, mesh)</span>
          <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="o">.</span><span class="n">getPlaneLetter</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
      <span class="n">position_list</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getYmesh</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">position_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">position</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
          <span class="n">snapshot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
          <span class="n">snapshot</span><span class="o">.</span><span class="n">setExtension</span><span class="p">([</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">position</span><span class="p">,</span> <span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                                <span class="p">[</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">position</span><span class="p">,</span> <span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
          <span class="c1">#snapshot.write_entry(FILE, mesh)</span>
          <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="n">position_list</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getZmesh</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">position_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">position</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
          <span class="n">snapshot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseSnapshot</span><span class="p">)</span>
          <span class="n">snapshot</span><span class="o">.</span><span class="n">setExtension</span><span class="p">([</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">position</span><span class="p">],</span>
                                <span class="p">[</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">position</span><span class="p">])</span>
          <span class="c1">#snapshot.write_entry(FILE, mesh)</span>
          <span class="n">added_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>
      
    <span class="k">return</span> <span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">added_snapshots</span><span class="p">)</span></div>

<div class="viewcode-block" id="SnapshotBoxVolume.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxVolume.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">added_snapshots</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupSnapshots</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">snapshot</span> <span class="ow">in</span> <span class="n">added_snapshots</span><span class="p">:</span>
      <span class="n">snapshot</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">added_snapshots</span></div>

<div class="viewcode-block" id="SnapshotBoxVolume.write_data"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.SnapshotBoxVolume.write_data">[docs]</a>  <span class="k">def</span> <span class="nf">write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">added_snapshots</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupSnapshots</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">added_snapshots</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">snapshot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">added_snapshots</span><span class="p">):</span>
      <span class="n">snapshot</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">numID</span><span class="o">+</span><span class="n">idx</span><span class="p">,</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="n">destdir</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">added_snapshots</span></div></div>

<span class="c1">#class SnapshotBoxVolumeMeshIndependent(object):</span>
  <span class="c1">#pass</span>

<div class="viewcode-block" id="EnergySnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EnergySnapshot">[docs]</a><span class="k">class</span> <span class="nc">EnergySnapshot</span><span class="p">(</span><span class="n">FrequencySnapshot</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_repetition</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
    <span class="k">return</span>

<div class="viewcode-block" id="EnergySnapshot.setFromSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EnergySnapshot.setFromSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">snapshot_in</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;epsilon_repetition&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">snapshot_in</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_repetition</span> <span class="o">=</span> <span class="n">snapshot_in</span><span class="o">.</span><span class="n">epsilon_repetition</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="EnergySnapshot.setupEpsilonSnapshot"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EnergySnapshot.setupEpsilonSnapshot">[docs]</a>  <span class="k">def</span> <span class="nf">setupEpsilonSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1">#print(&#39;EnergySnapshot.write_entry&#39;)</span>
    
    <span class="c1"># create an epsilon snapshot</span>
    <span class="n">epsilon_snapshot</span> <span class="o">=</span> <span class="n">EpsilonSnapshot</span><span class="p">()</span>
    <span class="n">epsilon_snapshot</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1">#epsilon_snapshot.setExtensionFromSnapshot(self)</span>
    <span class="n">epsilon_snapshot</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">epsilon_snapshot</span><span class="o">.</span><span class="n">repetition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_repetition</span>
    
    <span class="c1">#print(epsilon_snapshot.getPlaneLetter())</span>
    <span class="c1">#print(epsilon_snapshot.getExtension())</span>
    <span class="k">return</span><span class="p">(</span><span class="n">epsilon_snapshot</span><span class="p">)</span></div>

<div class="viewcode-block" id="EnergySnapshot.getSplitSnapshots"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EnergySnapshot.getSplitSnapshots">[docs]</a>  <span class="k">def</span> <span class="nf">getSplitSnapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the epsilon and frequency snapshots that would be used.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">epsilon_snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupEpsilonSnapshot</span><span class="p">()</span>
    <span class="n">frequency_snapshot</span> <span class="o">=</span> <span class="n">FrequencySnapshot</span><span class="p">()</span>
    <span class="n">frequency_snapshot</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">epsilon_snapshot</span><span class="p">,</span> <span class="n">frequency_snapshot</span><span class="p">]</span></div>

<div class="viewcode-block" id="EnergySnapshot.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EnergySnapshot.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    <span class="n">epsilon_snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupEpsilonSnapshot</span><span class="p">()</span>
    
    <span class="c1"># write the epsilon snapshot</span>
    <span class="n">epsilon_snapshot</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    
    <span class="c1"># write the frequency snapshot using the FrequencySnapshot.write_entry function</span>
    <span class="n">FrequencySnapshot</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>

    <span class="k">return</span></div>

<div class="viewcode-block" id="EnergySnapshot.write_data"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EnergySnapshot.write_data">[docs]</a>  <span class="k">def</span> <span class="nf">write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    .. todo:: The speed could be improved here by writing epsilon and frequency snapshots at the same time, since we need to compute the sample function on both for the same points. Is it worth optimizing the sampling for tests?</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">epsilon_snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupEpsilonSnapshot</span><span class="p">()</span>
    <span class="n">epsilon_snapshot</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">numID</span><span class="p">,</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="n">destdir</span><span class="p">)</span>
    <span class="n">FrequencySnapshot</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">numID</span><span class="p">,</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="n">destdir</span><span class="p">)</span>
    <span class="k">return</span></div></div>

<span class="c1">#-----------------------------------------------------------------------</span>
<span class="c1"># Are those really necessary? Their only function is to make P1,P2 cover the whole mesh easier. Why not simply use setExtension? Or easy setXfull(), etc functions in the base Snapshot class?</span>
<span class="c1">#class FrequencySnapshotFull(FrequencySnapshot):</span>
  <span class="c1">#pass</span>

<span class="c1">#class TimeSnapshotFull(TimeSnapshot):</span>
  <span class="c1">#pass</span>

<span class="c1">#class ModeFilteredProbeFull(ModeFilteredProbe):</span>
  <span class="c1">#pass</span>

<span class="c1">#class EpsilonSnapshotFull(EpsilonSnapshot):</span>
  <span class="c1">#pass</span>
<span class="c1">#-----------------------------------------------------------------------</span>

<div class="viewcode-block" id="EpsilonBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EpsilonBox">[docs]</a><span class="k">class</span> <span class="nc">EpsilonBox</span><span class="p">(</span><span class="n">EpsilonSnapshot</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtension</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setFullExtensionOff</span><span class="p">()</span>

<div class="viewcode-block" id="EpsilonBox.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EpsilonBox.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1">#print(&#39;EpsilonBox.write_entry&#39;)</span>

    <span class="n">base_snapshot</span> <span class="o">=</span> <span class="n">EpsilonSnapshot</span><span class="p">()</span>
    <span class="n">base_snapshot</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">snapshot_box</span> <span class="o">=</span> <span class="n">SnapshotBoxVolume</span><span class="p">()</span>
    <span class="n">snapshot_box</span><span class="o">.</span><span class="n">setBaseSnapshot</span><span class="p">(</span><span class="n">base_snapshot</span><span class="p">)</span>
    <span class="n">snapshot_box</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    
    <span class="k">return</span></div></div>

<div class="viewcode-block" id="EpsilonBoxFull"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EpsilonBoxFull">[docs]</a><span class="k">class</span> <span class="nc">EpsilonBoxFull</span><span class="p">(</span><span class="n">EpsilonBox</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setFullExtensionOn</span><span class="p">()</span>

<div class="viewcode-block" id="EpsilonBoxFull.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.EpsilonBoxFull.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">mesh</span> <span class="o">=</span> <span class="n">MeshObject</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtension</span><span class="p">(</span><span class="o">*</span><span class="n">mesh</span><span class="o">.</span><span class="n">getExtension</span><span class="p">())</span>
    <span class="n">EpsilonBox</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="k">return</span></div></div>

<div class="viewcode-block" id="TimeSnapshotBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshotBox">[docs]</a><span class="k">class</span> <span class="nc">TimeSnapshotBox</span><span class="p">(</span><span class="n">TimeSnapshot</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtension</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setFullExtensionOff</span><span class="p">()</span>
    
<div class="viewcode-block" id="TimeSnapshotBox.setupSnapshotBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshotBox.setupSnapshotBox">[docs]</a>  <span class="k">def</span> <span class="nf">setupSnapshotBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">base_snapshot</span> <span class="o">=</span> <span class="n">TimeSnapshot</span><span class="p">()</span>
    <span class="n">base_snapshot</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">snapshot_box</span> <span class="o">=</span> <span class="n">SnapshotBoxVolume</span><span class="p">()</span>
    <span class="n">snapshot_box</span><span class="o">.</span><span class="n">setBaseSnapshot</span><span class="p">(</span><span class="n">base_snapshot</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">snapshot_box</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeSnapshotBox.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshotBox.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">snapshot_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupSnapshotBox</span><span class="p">()</span>
    <span class="n">snapshot_box</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="k">return</span></div>
  
<div class="viewcode-block" id="TimeSnapshotBox.write_data"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshotBox.write_data">[docs]</a>  <span class="k">def</span> <span class="nf">write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="n">snapshot_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupSnapshotBox</span><span class="p">()</span>
    <span class="n">snapshot_box</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">numID</span><span class="p">,</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="n">destdir</span><span class="p">)</span>
    <span class="k">return</span></div></div>

<div class="viewcode-block" id="TimeSnapshotBoxFull"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshotBoxFull">[docs]</a><span class="k">class</span> <span class="nc">TimeSnapshotBoxFull</span><span class="p">(</span><span class="n">TimeSnapshotBox</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example usage::</span>
<span class="sd">    </span>
<span class="sd">      Tbox=TimeSnapshotBoxFull()</span>
<span class="sd">      sim.appendSnapshot(Tbox)</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setFullExtensionOn</span><span class="p">()</span>

<div class="viewcode-block" id="TimeSnapshotBoxFull.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.TimeSnapshotBoxFull.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">mesh</span> <span class="o">=</span> <span class="n">MeshObject</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtension</span><span class="p">(</span><span class="o">*</span><span class="n">mesh</span><span class="o">.</span><span class="n">getExtension</span><span class="p">())</span>
    <span class="n">TimeSnapshotBox</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="k">return</span></div></div>

<div class="viewcode-block" id="ModeVolumeBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBox">[docs]</a><span class="k">class</span> <span class="nc">ModeVolumeBox</span><span class="p">(</span><span class="n">EnergySnapshot</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  This one is definitely necessary and should be as easy to use as possible.</span>
<span class="sd">  </span>
<span class="sd">  The other necessity is an EpsilonBox for geometry checking. Perhaps with Nx,Ny,Nz specification for mesh independence.</span>
<span class="sd">  </span>
<span class="sd">  .. todo:: need to make sure BFDTD does no weird auto-snap to mesh</span>
<span class="sd">  </span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtension</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setFullExtensionOff</span><span class="p">()</span>
    <span class="c1">#self.epsilon_repetition = int(1e9)</span>
    <span class="c1">#self.baseSnapshot = EpsilonSnapshot()</span>
    <span class="c1">#FrequencySnapshot.__init__(self)</span>
    <span class="c1">#self.name = self.__class__.__name__</span>
    <span class="c1">#self.layer = self.__class__.__name__</span>
    <span class="c1">#self.group = self.__class__.__name__</span>

<div class="viewcode-block" id="ModeVolumeBox.setupEnergySnapshotBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBox.setupEnergySnapshotBox">[docs]</a>  <span class="k">def</span> <span class="nf">setupEnergySnapshotBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1">#print(&#39;ModeVolumeBox.write_entry&#39;)</span>

    <span class="n">base_snapshot</span> <span class="o">=</span> <span class="n">EnergySnapshot</span><span class="p">()</span>
    <span class="n">base_snapshot</span><span class="o">.</span><span class="n">setFromSnapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">energy_snapshot_box</span> <span class="o">=</span> <span class="n">SnapshotBoxVolume</span><span class="p">()</span>
    <span class="n">energy_snapshot_box</span><span class="o">.</span><span class="n">setBaseSnapshot</span><span class="p">(</span><span class="n">base_snapshot</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">energy_snapshot_box</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModeVolumeBox.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBox.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">energy_snapshot_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupEnergySnapshotBox</span><span class="p">()</span>
    <span class="n">energy_snapshot_box</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>
    <span class="k">return</span></div>
  
<div class="viewcode-block" id="ModeVolumeBox.write_data"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBox.write_data">[docs]</a>  <span class="k">def</span> <span class="nf">write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">probe_ident</span> <span class="o">=</span> <span class="s1">&#39;_id_&#39;</span><span class="p">,</span> <span class="n">snap_time_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="n">energy_snapshot_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupEnergySnapshotBox</span><span class="p">()</span>
    <span class="n">energy_snapshot_box</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">sampling_function</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">numID</span><span class="p">,</span> <span class="n">probe_ident</span><span class="p">,</span> <span class="n">snap_time_number</span><span class="p">,</span> <span class="n">destdir</span><span class="o">=</span><span class="n">destdir</span><span class="p">)</span>
    <span class="k">return</span></div></div>


<div class="viewcode-block" id="ModeVolumeBoxFull"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBoxFull">[docs]</a><span class="k">class</span> <span class="nc">ModeVolumeBoxFull</span><span class="p">(</span><span class="n">ModeVolumeBox</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example usage::</span>
<span class="sd">    </span>
<span class="sd">      MV=ModeVolumeBoxFull()</span>
<span class="sd">      sim.appendSnapshot(MV)</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setFullExtensionOn</span><span class="p">()</span>
  
<div class="viewcode-block" id="ModeVolumeBoxFull.setup"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBoxFull.setup">[docs]</a>  <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    to call before using</span>
<span class="sd">    .. todo:: mesh keeps having to be passed arround. Define as attribute?</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">mesh</span> <span class="o">=</span> <span class="n">MeshObject</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setExtension</span><span class="p">(</span><span class="o">*</span><span class="n">mesh</span><span class="o">.</span><span class="n">getExtension</span><span class="p">())</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="ModeVolumeBoxFull.getEnergySnapshots"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBoxFull.getEnergySnapshots">[docs]</a>  <span class="k">def</span> <span class="nf">getEnergySnapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the energy snapshots that would be written. Useful for counting the resulting number of snapshots and split-writing.</span>
<span class="sd">    .. todo:: create this function at a lower level, so it works for other boxes, etc + make use of it when finally writing</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">energy_snapshot_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">)</span>
    <span class="n">energy_snapshot_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setupEnergySnapshotBox</span><span class="p">()</span>
    <span class="p">(</span><span class="n">used_mesh</span><span class="p">,</span> <span class="n">energy_snapshot_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">energy_snapshot_box</span><span class="o">.</span><span class="n">setupSnapshots</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">energy_snapshot_list</span></div>
    
<div class="viewcode-block" id="ModeVolumeBoxFull.getSplitSnapshots"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBoxFull.getSplitSnapshots">[docs]</a>  <span class="k">def</span> <span class="nf">getSplitSnapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">energy_snapshot_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getEnergySnapshots</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">)</span>
    <span class="n">epsilon_snapshot_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">frequency_snapshot_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">energy_snapshot</span> <span class="ow">in</span> <span class="n">energy_snapshot_list</span><span class="p">:</span>
      <span class="n">esnap</span><span class="p">,</span> <span class="n">fsnap</span> <span class="o">=</span> <span class="n">energy_snapshot</span><span class="o">.</span><span class="n">getSplitSnapshots</span><span class="p">()</span>
      <span class="n">epsilon_snapshot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esnap</span><span class="p">)</span>
      <span class="n">frequency_snapshot_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fsnap</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">epsilon_snapshot_list</span><span class="p">,</span> <span class="n">frequency_snapshot_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModeVolumeBoxFull.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.ModeVolumeBoxFull.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">)</span>
    <span class="n">ModeVolumeBox</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">)</span>
    <span class="k">return</span></div></div>

    <span class="c1"># TODO: solve inf recursion</span>
    <span class="c1">#base_epsilon_snapshot = EpsilonSnapshot</span>
    <span class="c1">#base_snapshot.setExtensionFromSnapshot(self)</span>
    <span class="c1">#snapshot_stats</span>

    <span class="c1">#SnapshotBoxVolume.write_entry(self, FILE, mesh)</span>

    <span class="c1">#return</span>
    <span class="c1">#energy_snapshot_box = SnapshotBoxVolume()</span>
    <span class="c1">#energy_snapshot_box.setBaseSnapshot(self)</span>
    
    
    <span class="c1">#self.write_entry(FILE, mesh)</span>

    <span class="c1">#epsilon_snapshot_box = SnapshotBoxVolume()</span>
    <span class="c1">#epsilon_snapshot_box.setBaseSnapshot(self)</span>
    <span class="c1">#epsilon_snapshot_box.getBaseSnapshot().first = 1</span>
    <span class="c1">#epsilon_snapshot_box.getBaseSnapshot().repetition = self.epsilon_repetition</span>

    <span class="c1">#frequency_snapshot_box = SnapshotBoxVolume()</span>
    <span class="c1">#frequency_snapshot_box.setBaseSnapshot(self)</span>
    
    <span class="c1">#epsilon_snapshot_box.write_entry(FILE, mesh)</span>
    <span class="c1">#FrequencySnapshot.write_entry(self, FILE, mesh)</span>
    <span class="c1">#frequency_snapshot_box</span>
    <span class="c1">#return</span>

    <span class="c1">#esnap = EpsilonSnapshot()</span>
    <span class="c1">#esnap.plane = self.plane</span>

    <span class="c1">#fsnap = FrequencySnapshot()</span>
    <span class="c1">#fsnap.plane = self.plane</span>
    <span class="c1">#fsnap.setFrequencies(self.frequency_vector)</span>

    <span class="c1">## TODO: It seems we could use a fsnap+esnap combo as well...</span>

    <span class="c1">#if self.plane == 1:</span>
      <span class="c1">#xmin_idx, xmin_val = findNearest(mesh.getXmesh(), self.P1[0])</span>
      <span class="c1">#xmax_idx, xmax_val = findNearest(mesh.getXmesh(), self.P2[0])</span>
      <span class="c1">#ymin = self.P1[1]</span>
      <span class="c1">#zmin = self.P1[2]</span>
      <span class="c1">#ymax = self.P2[1]</span>
      <span class="c1">#zmax = self.P2[2]</span>
      <span class="c1">#for idx in range(xmin_idx, xmax_idx+1):</span>
        <span class="c1">#x = mesh.getXmesh()[idx]</span>
        <span class="c1">#esnap.setExtension([x, ymin, zmin], [x, ymax, zmax])</span>
        <span class="c1">#esnap.write_entry(FILE, mesh)</span>
        <span class="c1">#fsnap.setExtension([x, ymin, zmin], [x, ymax, zmax])</span>
        <span class="c1">#fsnap.write_entry(FILE, mesh)</span>
    
    <span class="c1">#findNearest(mesh.getXmesh(), self.P1[0])</span>
    <span class="c1">#findNearest(mesh.getYmesh(), self.P1[1])</span>
    <span class="c1">#findNearest(mesh.getZmesh(), self.P1[2])</span>
    <span class="c1">#snapped_P1 = mesh.getNearest(self.P1)</span>
    <span class="c1">#snapped_P2 = mesh.getNearest(self.P2)</span>
    <span class="c1">#print(snapped_P1)</span>
    <span class="c1">#print(snapped_P2)</span>
    
    <span class="c1">#return</span>

  <span class="c1">#def setSnapshotTypeToPlane(self):</span>
    <span class="c1">#self.snapshot_type = &#39;plane&#39;</span>
  <span class="c1">#def setSnapshotTypeToBoxSurface(self):</span>
    <span class="c1">#self.snapshot_type = &#39;box_surface&#39;</span>
  <span class="c1">#def setSnapshotTypeToBoxVolume(self):</span>
    <span class="c1">#self.snapshot_type = &#39;box_volume&#39;</span>
  
  <span class="c1">#def setFullExtension(self, full_extension_bool):</span>
    <span class="c1">#self.full_extension_bool = full_extension_bool</span>
  
  <span class="c1">#def writePlane(self, mesh_object=None):</span>
    <span class="c1">#raise Exception(&#39;This function has to be implemented by child classes.&#39;)</span>
    <span class="c1">#return</span>

  <span class="c1">#def writeBoxSurface(self, mesh_object=None):</span>
    <span class="c1">#raise Exception(&#39;This function has to be implemented by child classes.&#39;)</span>
    <span class="c1">#return</span>

  <span class="c1">#def writeBoxVolume(self, mesh_object=None):</span>
    <span class="c1">#raise Exception(&#39;This function has to be implemented by child classes.&#39;)</span>
    <span class="c1">#return</span>
  
  <span class="c1">#def write(self, mesh_object=None):</span>
    <span class="c1">#&#39;&#39;&#39;</span>
    <span class="c1">#* Uses write_entry function from the subclass calling it.</span>
    <span class="c1">#* If mesh is None, it simply creates a single snapshot, otherwise, depending on the other attributes, it writes multiple snapshots based on the mesh</span>
    <span class="c1">#* To increase speed (ex: when a lot of snapshots are written), we should directly pass computed information like the mesh size.</span>
    <span class="c1">#* No attributes should be modified by this function!</span>
    <span class="c1">#&#39;&#39;&#39;</span>
    <span class="c1">#if self.snapshot_type == &#39;plane&#39;:</span>
      <span class="c1">#self.writePlane(mesh_object)</span>
    <span class="c1">#elif self.snapshot_type == &#39;box_surface&#39;:</span>
      <span class="c1">#self.writeBoxSurface(mesh_object)</span>
    <span class="c1">#elif self.snapshot_type == &#39;box_volume&#39;:</span>
      <span class="c1">#self.writeBoxVolume(mesh_object)</span>
    <span class="c1">#else:</span>
      <span class="c1">#print(&#39;ERROR: Invalid snapshot type.&#39;, file=sys.stderr)</span>
      <span class="c1">#sys.exit(-1)</span>

    <span class="c1">#if self.plane </span>
    
    <span class="c1">##if mesh_object:</span>
      <span class="c1">##(mesh_size, mesh_resolution) = mesh_object.getSizeAndResolution()</span>

    <span class="c1">## extension</span>
    <span class="c1">#if self.full_extension_bool:</span>
      <span class="c1">#self.P1 = [0,0,0]</span>
      <span class="c1">#self.P2 = mesh_size</span>

    <span class="c1">#if self.name is None:</span>
      <span class="c1">#planeIdx_bfdtd2letter(self.plane).upper()</span>
      
      <span class="c1">#self.name = [&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39;]&#39;X &#39;+self.__name__</span>

    <span class="c1">#centro_vec3 = self.getCentro()</span>
    
    <span class="c1">#if self.plane == 1:</span>
      <span class="c1">#if self.name is None:</span>
        <span class="c1">#self.name = &#39;X &#39;+self.__name__</span>
      <span class="c1">#self.P1[0] = centro_vec3[0]</span>
    <span class="c1">#elif self.plane == 2:</span>
      <span class="c1">#if self.name is None:</span>
        <span class="c1">#self.name = &#39;Y &#39;+self.__name__</span>
      <span class="c1">#self.P1[1] = centro_vec3[1]</span>
    <span class="c1">#elif self.plane == 3:</span>
      <span class="c1">#if self.name is None:</span>
        <span class="c1">#self.name = &#39;Z &#39;+self.__name__</span>
      <span class="c1">#self.P1[2] = centro_vec3[2]</span>
    <span class="c1">#else:</span>
      <span class="c1">#print((&#39;ERROR: Invalid plane : &#39;,plane))</span>
      <span class="c1">#sys.exit(1)</span>
    <span class="c1">#S = snapshot_class(name=name, plane=plane_bfdtdidx, P1=L, P2=U)</span>
    <span class="c1">#self.snapshot_list.append(S)</span>
    <span class="c1">#return S</span>

  <span class="c1">#def __init__(self):</span>
    <span class="c1">#self.location = array([0.5, 0.5, 0.5])</span>
    <span class="c1">#self.dimensions = array([1, 1, 1])</span>
  <span class="c1">#def getLocation(self):</span>
    <span class="c1">#return self.location</span>
  <span class="c1">#def getSize(self):</span>
    <span class="c1">#return self.dimensions</span>
  <span class="c1">#def setLocation(self, location):</span>
    <span class="c1">#self.location = location</span>
  <span class="c1">#def setSize(self, dimensions):</span>
    <span class="c1">#self.dimensions = dimensions</span>

  <span class="c1">#def getLowerAbsolute(self):</span>
    <span class="c1">#return self.location - 0.5*self.dimensions</span>
  <span class="c1">#def getUpperAbsolute(self):</span>
    <span class="c1">#return self.location + 0.5*self.dimensions</span>

  <span class="c1">#def setLowerAbsolute(self):</span>
    <span class="c1">#P2 = self.getUpperAbsolute()</span>
    <span class="c1">#return self.location - 0.5*self.dimensions</span>
  <span class="c1">#def setUpperAbsolute(self):</span>
    <span class="c1">#return self.location + 0.5*self.dimensions</span>
  
  <span class="c1">#pass</span>

<div class="viewcode-block" id="test_interactive"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.snapshot.test_interactive">[docs]</a><span class="k">def</span> <span class="nf">test_interactive</span><span class="p">():</span>
  <span class="c1"># read in ~/.pystartup to have all the desired modules</span>
  <span class="n">pystartup</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.pystartup&quot;</span><span class="p">)</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pystartup</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">code_object</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">pystartup</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">code_object</span><span class="p">)</span>

  <span class="n">s</span> <span class="o">=</span> <span class="n">Snapshot</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
  <span class="c1">#s.write_entry()</span>
  
  <span class="n">f</span> <span class="o">=</span> <span class="n">FrequencySnapshot</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
  <span class="n">f</span><span class="o">.</span><span class="n">write_entry</span><span class="p">()</span>

  <span class="n">t</span> <span class="o">=</span> <span class="n">TimeSnapshot</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">t</span><span class="o">.</span><span class="n">write_entry</span><span class="p">()</span>

  <span class="n">e</span> <span class="o">=</span> <span class="n">EpsilonSnapshot</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
  <span class="n">e</span><span class="o">.</span><span class="n">write_entry</span><span class="p">()</span>

  <span class="n">m</span> <span class="o">=</span> <span class="n">ModeFilteredProbe</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
  <span class="n">m</span><span class="o">.</span><span class="n">write_entry</span><span class="p">()</span>

  <span class="n">code</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">local</span><span class="o">=</span><span class="nb">locals</span><span class="p">())</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
  <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">script_inception_public  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Mike Taverne.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>